<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Compilar cuestionario</title>
</head>
<body>

<h1 th:text="${submission.questionnaire.title}"></h1>

<p>
    <b>Código:</b> <span th:text="${submission.accessCode}"></span><br>
    <b>Estado:</b> <span th:text="${submission.status}"></span>
</p>

<div th:if="${param.final}">
    <p style="color:green"><b>Cuestionario enviado como definitivo.</b> Guarda tu código.</p>
</div>

<form th:action="@{/submissions/{code}/save(code=${submission.accessCode})}" method="post">

    <div th:each="a : ${submission.answers}">
        <p>
            <b th:text="${a.question.text}"></b><br>

        <div th:if="${a.question.type.name() == 'OPEN'}">
            <label th:for="${'answer_' + a.question.id}">Respuesta:</label>
            <input type="text"
                   th:id="${'answer_' + a.question.id}"
                   th:name="${'answer_' + a.question.id}"
                   th:value="${a.textAnswer}">
        </div>

        <div th:if="${a.question.type.name() == 'MULTIPLE_CHOICE'}">
            <label th:for="${'answer_' + a.question.id}">Respuesta:</label>
            <input type="text"
                   th:id="${'answer_' + a.question.id}"
                   th:name="${'answer_' + a.question.id}"
                   th:value="${a.choiceAnswer}">
            <small></small>
        </div>
        </p>
        <hr>
    </div>

    <button type="submit">Guardar borrador</button>
</form>

<form th:action="@{/submissions/{code}/submit(code=${submission.accessCode})}" method="post">
    <div th:each="a : ${submission.answers}">
        <input type="hidden"
               th:name="${'answer_' + a.question.id}"
               th:value="${a.question.type.name() == 'OPEN' ? a.textAnswer : a.choiceAnswer}">
    </div>
    <button type="submit">Enviar definitivo</button>
</form>

<form th:action="@{/submissions/{code}/delete(code=${submission.accessCode})}" method="post">
    <button type="submit">Borrar cuestionario compilado</button>
</form>

</body>
</html>